"0","expos = c(""35MF19940126"", ""35MF19950927"", ""35MF19980121"", ""35MF20040103"")"
"0","for(ex in expos){"
"0","  path = paste(""E:/Data_downloads/SISMER"", ex, ""ctd"", sep = ""/"")"
"0","  fname = list.files(path, pattern = ""*.txt"")"
"0","  fl = file.path(path,fname)"
"0"," "
"0","  f <- file( fl, open = ""r"" )"
"0","      n = 0"
"0","      while( TRUE ){"
"0","        line <- readLines( f, 1L )"
"0","        n = n+1"
"0","        if(BIOMATE::is.empty(line)){next}"
"0","        if(substr(line,1,2) != ""//""){break}"
"0","      }"
"0","      close(f)"
"0","  data = read.table(file = fl, header = T, sep = ""\t"", stringsAsFactors = F, strip.white = T,fill = T, skip = n-1)"
"0","  "
"0","  # change header names "
"0","  if(ex == ""35MF19940126"" | ex == ""35MF19950927""){"
"0","  colnames(data)[c(4,5,6,10,12,14,16)] = c(""TIME"",""LATITUDE"", ""LONGITUDE"",""PRES"", ""TEMP"", ""PSAL"", ""DOXY"")}"
"0","  if(ex == ""35MF19980121""){colnames(data)[c(4,5,6,10,14,16)] = c(""TIME"",""LATITUDE"", ""LONGITUDE"",""PRES"", ""TEMP"", ""PSAL"")}"
"0","  if(ex == ""35MF20040103""){colnames(data)[c(4,5,6,10,14,16,18)] = c(""TIME"",""LATITUDE"", ""LONGITUDE"",""PRES"", ""TEMP"", ""PSAL"",""FLUOR"")}"
"0","  "
"0","  # split according to finite station type"
"0","  idx = which(is.finite(data$Station))"
"0","  for(st in 1:length(idx)){"
"0","    if(st == length(idx)){sub_data = data[idx[st]:length(data),]}else{sub_data = data[idx[st]:(idx[st+1]-1),]}"
"0","    "
"0","  "
"0","    # fill in missing values"
"0","    sub_data[,c(""Cruise"",""Station"", ""TIME"", ""LATITUDE"", ""LONGITUDE"")] = sub_data[1,c(""Cruise"",""Station"", ""TIME"", ""LATITUDE"", ""LONGITUDE"")]"
"0","    "
"0","    # save file in new split directory"
"0","    write.csv(sub_data, file.path(paste(""E:/Data_downloads/SISMER"", ex, ""ctd"",""split"", sep = ""/""), paste(ex,""ctd_"", sub_data$Station[1],"".csv"", sep = """")), row.names = F )"
"0","  }"
"0","  "
"0","}"
